# 摄像头头像功能测试指南

## 测试步骤

### 1. 启动游戏
- 在浏览器中打开: http://localhost:8000
- 游戏会自动加载到角色选择界面

### 2. 测试角色选择
- 点击任意角色头像为玩家1选择（会显示绿色边框）
- 再点击另一个角色为玩家2选择（会显示蓝色边框）

### 3. 测试摄像头捕获
**玩家1头像捕获:**
- 按下 **Q** 键
- 浏览器会请求摄像头权限（首次使用）
- 允许权限后，会自动捕获当前摄像头画面
- 控制台会显示 "Player 1 custom head set"

**玩家2头像捕获:**
- 按下 **P** 键
- 会捕获当前摄像头画面
- 控制台会显示 "Player 2 custom head set"

### 4. 开始游戏
- 按**空格键**开始游戏
- 观察角色身体上是否显示了捕获的头像

### 5. 验证头像显示
检查以下内容：
- [ ] 头像是否显示在正确的位置（角色头部）
- [ ] 头像是否为圆形
- [ ] 头像是否随角色移动
- [ ] 头像是否随角色朝向改变而调整
- [ ] 不同状态下头像位置是否正确（normal, attacking, attacked, knocked）

### 6. 测试不同场景
- 角色向左移动（按 A 键）
- 角色向右移动（按 D 键）
- 角色攻击（按 A 键）
- 角色受击
- 角色被击倒

### 7. 重置测试
- 游戏结束后按空格键返回角色选择
- 验证摄像头资源是否正确清理
- 重新选择角色和捕获头像

## 预期结果

✅ **成功标准:**
1. 摄像头权限请求正常
2. 头像捕获成功，无错误
3. 头像显示为圆形，位置正确
4. 头像随角色移动和朝向变化
5. 不同状态下头像位置适配正确
6. 游戏重置后摄像头资源清理

❌ **可能的问题:**
1. 浏览器不支持摄像头 API
2. 用户拒绝摄像头权限
3. 头像位置不准确（需要调整 characters.json 中的 head 配置）
4. 头像旋转角度不正确

## 调试技巧

1. **打开浏览器控制台** (F12)
   - 查看是否有错误信息
   - 查看 "Camera initialized successfully" 消息
   - 查看 "Player X custom head set" 消息

2. **检查摄像头权限**
   - 确保浏览器有摄像头访问权限
   - 检查浏览器地址栏的权限图标

3. **调整头像位置**
   - 如果头像位置不准确，修改 `characters.json` 中对应状态的 `head` 配置
   - 调整 `x`, `y`, `w`, `h` 参数

4. **调整头像旋转**
   - 修改 `direction` 参数（90为正常朝向）
   - 0度为水平，90度为垂直

## 浏览器兼容性

- ✅ Chrome/Edge (推荐)
- ✅ Firefox
- ✅ Safari (需要 HTTPS 或 localhost)
- ❌ 不支持摄像头的浏览器

## 注意事项

1. 摄像头功能需要在 HTTPS 或 localhost 环境下运行
2. 首次使用需要用户授予摄像头权限
3. 头像会被裁剪为正方形后显示为圆形
4. 捕获的是当前摄像头画面的快照
